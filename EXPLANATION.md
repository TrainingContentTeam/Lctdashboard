# LCT Dashboard - File Explanation Guide

This document explains what each major file/folder in the app is responsible for, so it is easier to maintain and extend.

## High-Level Structure

```
src/
  main.tsx                # App entry point
  app/
    App.tsx               # Global app state + file processing orchestration
    routes.tsx            # Route definitions
    pages/                # Top-level route pages
    components/           # Reusable feature components + uploader/charts/tables
    components/ui/        # Shared UI primitives (buttons, cards, inputs, etc.)
    utils/                # Data parsing, normalization, merge, and analytics logic
    lib/utils.ts          # Shared className helper
  styles/
    index.css             # Style import entry
    tailwind.css          # Tailwind v4 setup
    theme.css             # Design tokens and base styles
    fonts.css             # Font definitions/imports
```

## Root Config Files

- `package.json`: Scripts (`dev`, `build`) and all runtime/dev dependencies.
- `vite.config.ts`: Vite + React + Tailwind plugins, `@` alias to `src`, and additional asset includes (`.svg`, `.csv`).
- `postcss.config.mjs`: Placeholder config for optional extra PostCSS plugins.
- `index.html`: Vite HTML shell that mounts React at `#root` and loads `src/main.tsx`.
- `dist/`: Build output generated by Vite.

## App Bootstrapping

- `src/main.tsx`
  - Renders `<App />` into the root DOM node.
  - Imports global styles from `src/styles/index.css`.

- `src/app/App.tsx`
  - Hosts router provider and app-wide processing state:
    - upload step (`currentStep`)
    - parsed/merged courses (`unifiedData`)
    - computed aggregates (`analytics`)
    - validation errors
    - `lastUpdated`
  - Handles the full upload pipeline:
    1. Parse files
    2. Normalize/validate records
    3. Merge and classify courses
    4. Compute analytics
  - Exposes state/actions to pages through `Outlet` context.

- `src/app/routes.tsx`
  - Defines all routes using `createBrowserRouter`.
  - Wraps all pages with `AppRoot` so they share context.

## Data & Business Logic

- `src/app/utils/csvProcessor.ts` (primary data engine)
  - Parses uploaded CSV/Excel files with `xlsx`.
  - Normalizes three datasets:
    - Legacy course data
    - Modern course data
    - Time spent category data
  - Handles flexible header matching and type conversion (year, numeric duration).
  - Merges datasets into `UnifiedCourseData`.
  - Classifies courses as `Legacy`, `Modern`, or `In Progress`.
  - Computes aggregate analytics (`AggregatedAnalytics`) for dashboard views.
  - Exposes metadata extraction helpers used by filter UIs.

- `src/app/utils/dataProcessor.ts`
  - Older/general-purpose processing helper module.
  - Includes key normalization, merge logic, and analytics utilities for project/time-entry style datasets.
  - Useful for legacy compatibility or alternate data flows.

- `src/app/lib/utils.ts`
  - `cn(...)` utility combining `clsx` + `tailwind-merge` for className composition.

## Pages (Route-Level UI)

- `src/app/pages/DashboardPage.tsx`
  - Step-aware landing page:
    - Step 1: upload interface
    - Step 2: processing state
    - Step 3: analytics dashboard

- `src/app/pages/AllProjectsPage.tsx`
  - Card-based list of all courses/projects with search + advanced filters.
  - Links to per-project detail route.

- `src/app/pages/ProjectDetailPage.tsx`
  - Deep view for a single course+year:
    - key metrics
    - metadata summary
    - category pie chart
    - raw time-entry table

- `src/app/pages/CourseDetailsPage.tsx`
  - Table-focused detailed dataset explorer with full filtering controls.

- `src/app/pages/DevelopmentPage.tsx`
  - Development-focused analytics (year-over-year averages and category comparisons).

- `src/app/pages/SMEPage.tsx`
  - SME-focused analysis and tables for collaboration load and phase trends.

- `src/app/pages/ExternalTeamsPage.tsx`
  - External-team analytics (legal/CQO workloads and trend views).

## Components

- `src/app/components/Sidebar.tsx`
  - Main navigation; locks analytics pages until upload/processing is complete.

- `src/app/components/FileUpload.tsx`
  - 3-file upload workflow and process trigger.

- `src/app/components/ThreeFileUploader.tsx`
  - Drag-and-drop file uploader variant with file-type validation.

- `src/app/components/SimplifiedDashboard.tsx`
  - Main dashboard charts/tables and export-to-image actions.

- `src/app/components/FilterPanel.tsx`
  - Shared advanced filter system with multi-selects and metadata-driven options.

- `src/app/components/CourseDataTable.tsx`, `DataTable.tsx`, analytics/chart components
  - Reusable presentation components for tables, KPI cards, and charts.

- `src/app/components/ui/*`
  - Shared UI primitives (button/card/input/select/table/etc.), mostly reusable building blocks used throughout pages/components.

## Styling

- `src/styles/index.css`: Imports the style layers in order.
- `src/styles/tailwind.css`: Tailwind v4 source declarations and animation utilities.
- `src/styles/theme.css`: CSS variables/tokens (colors, spacing, radii, typography) + base element styles.
- `src/styles/fonts.css`: Font setup (currently empty in this project).

## Typical Data Flow

1. User uploads 3 files in Dashboard.
2. `AppRoot.handleFilesUploaded` calls parser/normalizer utilities.
3. Unified course records are generated and classified.
4. Aggregated analytics are computed and stored in shared context.
5. Route pages read context and render filtered charts/tables.

## Maintenance Tips

- If you are changing CSV header names or input formats, update matching logic in `csvProcessor.ts` first.
- If you add a new analytics page, define route in `routes.tsx` and add navigation in `Sidebar.tsx`.
- Keep data logic inside `utils/` and keep page/component files focused on rendering and interactions.
